{% extends "base.html" %}
{% load humanize %}

{% block content %}
<div class="container mt-5">
  <h3 class="fw-bold mb-4">ğŸ“‹ ë‚˜ì˜ íˆ¬ì ì„±í–¥</h3>

  <div class="card p-4">
    <h5 class="fw-semibold mb-3">
      ğŸ§  ë‹¹ì‹ ì˜ íˆ¬ì ì„±í–¥ì€
      <span class="text-primary">{{ investment_type }}</span> ì…ë‹ˆë‹¤.
    </h5>

    {% if last_test_date %}
      <p class="text-muted">ğŸ—“ï¸ ìµœê·¼ í…ŒìŠ¤íŠ¸ ì¼ì: {{ last_test_date|date:"Yë…„ mì›” dì¼ H:i" }}</p>
    {% else %}
      <p class="text-muted">ì•„ì§ íˆ¬ì ì„±í–¥ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
    {% endif %}

    <div class="mt-3">
      {% if investment_type == 'ê³µê²©íˆ¬ìí˜•' %}
        <p>ğŸ“ˆ ì‹œì¥ í‰ê·  ì´ìƒì˜ ë†’ì€ ìˆ˜ìµì„ ì¶”êµ¬í•˜ë©°, ì†ì‹¤ ìœ„í—˜ë„ ì ê·¹ ê°ìˆ˜í•˜ëŠ” ì„±í–¥ì…ë‹ˆë‹¤.</p>
      {% elif investment_type == 'ì ê·¹íˆ¬ìí˜•' %}
        <p>ğŸš€ ì¼ì • ìˆ˜ì¤€ì˜ ìœ„í—˜ì„ ê°ë‚´í•˜ê³  ë¹„êµì  ë†’ì€ ìˆ˜ìµì„ ì‹¤í˜„í•˜ë ¤ëŠ” ì„±í–¥ì…ë‹ˆë‹¤.</p>
      {% elif investment_type == 'ìœ„í—˜ì¤‘ë¦½í˜•' %}
        <p>âš–ï¸ ìˆ˜ìµê³¼ ìœ„í—˜ ì‚¬ì´ì—ì„œ ê· í˜•ì„ ì¶”êµ¬í•˜ë©°, ê²½ìš°ì— ë”°ë¼ ì¼ì • ìˆ˜ì¤€ì˜ ì†ì‹¤ì„ ê°ìˆ˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      {% elif investment_type == 'ì•ˆì •ì¶”êµ¬í˜•' %}
        <p>ğŸ”’ í° ì†ì‹¤ì€ í”¼í•˜ë©´ì„œë„ ì˜ˆÂ·ì ê¸ˆë³´ë‹¤ ë‚˜ì€ ìˆ˜ìµì„ ê¸°ëŒ€í•˜ëŠ” ì„±í–¥ì…ë‹ˆë‹¤.</p>
      {% elif investment_type == 'ì•ˆì •í˜•' %}
        <p>ğŸ’¼ ìì‚° ì†ì‹¤ì„ ì›ì¹˜ ì•Šìœ¼ë©°, ì˜ˆê¸ˆ ìˆ˜ì¤€ì˜ ì•ˆì •ì ì¸ ìˆ˜ìµì„ ê¸°ëŒ€í•˜ëŠ” ì„±í–¥ì…ë‹ˆë‹¤.</p>
      {% else %}
        <p>âš ï¸ ì„±í–¥ ì •ë³´ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
      {% endif %}
    </div>

    <a href="{% url 'user_analysis:intro' %}" class="btn btn-outline-primary mt-4">íˆ¬ì ì„±í–¥ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°</a>
  </div>

  {% if balance_info %}
  <div class="mt-5">
    <h4 class="fw-bold mb-3">ğŸ’° ë‚˜ì˜ ìì‚°</h4>
    <div class="card p-4">
      <div class="row text-center">
        <!-- ì˜ˆìˆ˜ê¸ˆ -->
        <div class="col-md-4 border-end">
          <p class="mb-1 text-muted">ì˜ˆìˆ˜ê¸ˆ</p>
          <h5 class="fw-bold">
            {{ balance_info.deposits.KRW.amount|floatformat:0|intcomma }} ì›
          </h5>
        </div>

        <!-- ì´ ìˆ˜ìµ -->
        <div class="col-md-4 border-end">
          <p class="mb-1 text-muted">í‰ê°€ ì†ìµ</p>
          <h5 class="fw-bold {% if balance_info.profit >= 0 %}text-danger{% else %}text-primary{% endif %}">
            {{ balance_info.profit|floatformat:0|intcomma }} ì›
          </h5>
        </div>

        <!-- ì´ ìˆ˜ìµë¥  -->
        <div class="col-md-4">
          <p class="mb-1 text-muted">ì´ ìˆ˜ìµë¥ </p>
          <h5 class="fw-bold">
            {{ balance_info.profit_rate|floatformat:2 }}%
          </h5>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <div class="mt-5">
    <h4 class="fw-bold mb-3">ğŸ“Š ë‚˜ì˜ ë³´ìœ  ì¢…ëª© ìš”ì•½</h4>

    {% if mock_results %}
      <div class="table-responsive">
        <table class="table table-bordered text-center align-middle">
          <thead class="table-light">
            <tr>
              <th>ì¢…ëª©</th>
              <th>ì†ìµ / ìˆ˜ìµë¥ </th>
              <th>ë³´ìœ  ìˆ˜ëŸ‰</th>
              <th>ë§¤ì…ê°€</th>
              <th>í˜„ì¬ê°€</th>
            </tr>
          </thead>
          <tbody>
            {% for result in mock_results %}
            <tr>
              <td class="text-center">
                <div class="fw-semibold">{{ result.stock_name }}</div>
              </td>
              <td class="text-nowrap">
                <div class="{% if result.profit >= 0 %}text-danger{% else %}text-primary{% endif %} fw-semibold">
                  {{ result.profit|intcomma }}ì›
                </div>
                <div class="{% if result.profit_rate >= 0 %}text-danger{% else %}text-primary{% endif %} small">
                  {{ result.profit_rate|floatformat:2 }}%
                </div>
              </td>
              <td>{{ result.qty }}ì£¼</td>
              <td>{{ result.purchase_price|intcomma }}ì›</td>
              <td class="text-nowrap">
                <div class="fw-semibold">{{ result.current_price|intcomma }}ì›</div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="alert alert-secondary text-center" role="alert">
        í˜„ì¬ ë³´ìœ  ì¤‘ì¸ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ğŸ“‰<br>
        <a href="{% url 'mock_investment:transaction' %}" class="btn btn-sm btn-outline-primary mt-2">
          ì¢…ëª© ë§¤ìˆ˜í•˜ëŸ¬ ê°€ê¸°
        </a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}