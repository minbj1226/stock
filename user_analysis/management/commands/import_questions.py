from django.core.management.base import BaseCommand
from user_analysis.models import Question, Choice

class Command(BaseCommand):
    help = "투자 성향 테스트 질문과 선택지를 DB에 저장합니다."

    def handle(self, *args, **kwargs):
        question_data = [
            {
                "text": "1. 당신의 연령대는 어떻게 되나요?",
                "choices": [
                    ("19세 이하", 12.5),
                    ("20세~40세", 12.5),
                    ("41세~50세", 9.3),
                    ("51세~60세", 6.2),
                    ("61세 이상", 3.1),
                ]
            },
            {
                "text": "2. 투자하고자 하는 돈을 얼마나 오래 투자할 계획인가요?",
                "choices": [
                    ("6개월 이하", 3.1),
                    ("6개월~1년 이하", 6.2),
                    ("1년~2년 이하", 9.3),
                    ("2년~3년 이하", 12.5),
                    ("3년 이상", 15.6),
                ]
            },
            {
                "text": "3. 당신이 해본 투자 경험 중 가장 가까운 것은 무엇인가요?",
                "choices": [
                    ("예금, 적금, 국채, 지방채 등", 3.1),
                    ("회사채, 채권형 펀드, 원금보장형 ELS 등", 6.2),
                    ("원금 일부 보장형 ELS, 혼합형 펀드 등", 9.3),
                    ("주식, 원금 비보장형 ELS, 시장 수익률 펀드 등", 12.5),
                    ("선물옵션, 파생상품, 주식 신용거래 등", 15.6),
                ]
            },
            {
                "text": "4. 금융 및 투자에 대한 본인의 지식수준은 어느 정도라고 생각하나요?",
                "choices": [
                    ("전혀 몰라요! 금융상품도 잘 몰라요.", 3.1),
                    ("기본적인 예금과 적금 정도는 알아요.", 6.2),
                    ("주식과 펀드 차이를 알고, 어느 정도 투자 경험이 있어요.", 9.3),
                    ("경제 뉴스나 기업 분석을 보고 투자할 수 있어요.", 12.5),
                    ("전문 투자자 수준! 직접 주식과 자산을 분석해요.", 0),
                ]
            },
            {
                "text": "5. 현재 투자하고자 하는 자금은 전체 자산에서 어느 정도의 비율을 차지하나요?",
                "choices": [
                    ("10% 이하", 15.6),
                    ("10%~20% 이하", 6.2),
                    ("20%~30% 이하", 3.1),
                    ("30%~40% 이하", 0),
                    ("40% 이상", 0),
                ]
            },
            {
                "text": "6. 다음 중 당신의 수입원을 가장 잘 나타내고 있는 것은 어느 것 인가요?",
                "choices": [
                    ("현재 일정한 수입이 발생, 향후 현재 수준을 유지하거나 증가해요.", 9.3),
                    ("현재 일정한 수입이 발생, 향후 감소하거나 불안정해요.", 6.2),
                    ("현재 일정한 수입이 없어요.", 3.1),
                ]
            },
            {
                "text": "7. 만약 투자원금에 손실이 발생할 경우 다음 중 감수할 수 있는 손실 수준은 어느 것 인가요?",
                "choices": [
                    ("무슨 일이 있어도 투자원금은 보전되어야 해요.", -6.2),
                    ("10% 미만까지는 손실을 감수할 수 있어요", 6.2),
                    ("20% 미만까지는 손실을 감수할 수 있어요", 12.5),
                    ("기대수익이 높다면 위험이 높아도 괜찮아요", 18.7),
                ]
            }
        ]

        Question.objects.all().delete()
        Choice.objects.all().delete()

        for idx, data in enumerate(question_data, start=1):
            q = Question.objects.create(number=idx, text=data["text"])
            for choice_text, value in data["choices"]:
                Choice.objects.create(question=q, text=choice_text, value=value)

        self.stdout.write(self.style.SUCCESS("✅ 모든 질문과 보기 등록 완료"))